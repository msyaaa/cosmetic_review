<%= render "shared/header" %>
<% breadcrumb :name_search, @keyword %>
<%= render "shared/breadcrumbs" %>
<div class="main-contents">
  <%# カテゴリー一覧 %>
  <div class="item-categories">
    <h2>
      カテゴリー一覧
    </h2>
    <%= link_to  posts_path, class: "category-button", id: 'categoBtn' do %>
      カテゴリーから探す
    <% end %>
    <div id="tree_menu">
      <ul class="categoryTree">
        <% @parents.each do |parent| %>
          <li class="category_parent">
            <%= link_to search_post_path(parent) do %>
              <input type="button" value="<%= parent.name %>" name="<%= parent.id %>" class="parent_btn">
            <% end %>
          </li>
        <% end %>
      </ul>
      <ul class="categoryTree-child">
      </ul>
      <ul class="categoryTree-grandchild">
      </ul>
    </div>
  </div>
  <%# /カテゴリー一覧 %>
  <div class='item-contents'>
    <% if @keyword == "" %>
      <h2 class='title'>検索結果</h2>
    <% else %>
      <h2 class='title'>「<%= @keyword %>」の検索結果</h2>
    <% end %>
    <% if @posts.empty? %>
      <p class="none-posts">該当するクチコミが見つかりません。検索条件を変えて、再度お試しください。</p>
    <% end %>
    <%# クチコミ一覧 %>
    <ul class="post-lists">
    <% @posts.each do |post| %>
      <li class='list'>
        <%= link_to post_path(post.id), class:"post-link" do %>
        <div class='post-img-content'>
          <%= image_tag post.image, class: "post-img" %>
        </div>
        <div class="post-info-contents">
          <div class='post-info1'>
            <h3 class='post-name'>
              商品名：<%= post.name %>
            </h3>
            <div class="post-evaluation">
              <%# <span>評価：</span> %>
                <span id="star-rate-<%= post.id %>"></span>
                <script>
                  $('#star-rate-<%= post.id %>').raty({
                    size: 36,
                    starOff: "<%= asset_path('star-off.png') %>",
                    starOn: "<%= asset_path('star-on.png') %>",
                    starHalf: "<%= asset_path('star-half.png') %>",
                    half: true,
                    readOnly: true,
                    score: <%= post.evaluation %>,
                  });
                </script>
                <%= post.evaluation %>
            </div>
            <div class="post-nickname show-sub">
              <%= post.user.nickname %>さん
            </div>
            <div class='item-price'>
              <span><%= post.price %>円(税込み)</span>
            </div>
          </div>
          <div class="post-info2">
            <div class="post-date show-sub">
              <%= post.created_at.strftime("%Y.%m.%d") %>
            </div>
          </div>
        </div>
        <% end %>
      </li>
    <% end %>
    </ul>
    <%# /クチコミ一覧 %>
  </div>
</div>
<%= render "shared/footer" %>